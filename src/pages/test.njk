---js
{
  layout: "layouts/base.njk",
  permalink: "/test/index.html",
  pagination: {
    data: "results",
    size: Infinity,
    alias: "result",
    reverse: true,
    before: function (data) {

      const groupBy = (input, key) => {
        return Object.entries(
          input.reduce((acc, currentValue) => {
            let groupKey = currentValue[key];
            if (!acc[groupKey]) {
              acc[groupKey] = [];
            }
            acc[groupKey].push(currentValue);
            return acc;
          }, {})
        ).map(([year, content]) => ({ year, content }));
      };

      const obj = groupBy(data, "year");

      return obj;

    }
  },
  eleventyComputed: {
    title: "Results (2015 - {{ result[0].year }})"
  }
}
---


{% for set in pagination.items %}
  <details{{ ' open' if loop.first }}>
    <summary>
      {{ set.year }}
    </summary>
    <table style="font-family:monospace;" cellpadding=2>
      <thead>
        <th scope="col">Pos</th>
        <th scope="col">Name</th>
        <th scope="col">Time</th>
      </thead>
      <tbody>
        {% for result in set.content | sort(attribute="position") %}
          <tr>
            <td>
              {{ result.position }}
            </td>
            <td>
              {{ result.name }}
            </td>
            <td>
              {{ result.time }}{% if result.limmer === true %}<sup>*</sup>{% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </details>
{% endfor %}
